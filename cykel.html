<!DOCTYPE html>
<html lang="da">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <title></title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header></header>
    <main>
        <section class="single_bike">
            <img class="s_bike_img" src="" alt="">
            <section class="info">
                <h1 class="s_model"></h1>
                <p class="s_color"></p>
                <p class="s_weight"></p>
                <p class="s_pris"></p>
            </section>


            <section class="details">
                <div class="tab">
                    <button class="tab_selected" data-detail="#desc" id="desc_tab">Beskrivelse</button>
                    <button class="tab_closed" data-detail="#specs" id="spec_tab">Specifikationer</button>
                    <button class="tab_closed" data-detail="#rev" id="rev_tab">Anmeldelser (0)</button>
                </div>

                <div id="desc" class="tabcontent">
                    <h2></h2>
                    <p></p>
                    <p></p>
                    <p></p>
                </div>

                <div id="specs" class="tabcontent">
                    <ul>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                    </ul>
                </div>

                <div id="rev" class="tabcontent">
                    <h2>Ingen anmeldelser fundet.</h2>
                </div>
            </section>
        </section>
    </main>
    <script>
        //Søger i adresselinjen efter ordet "id" og sætter konstanten id lig med
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get("id");

        console.log(id);

        let bike;

        const descTab = document.querySelector("#desc_tab");
        const desc = document.querySelector("#desc");

        const specTab = document.querySelector("#spec_tab");
        const specs = document.querySelector("#specs");

        const revTab = document.querySelector("#rev_tab");
        const rev = document.querySelector("#rev");

        let detail;


        document.addEventListener("DOMContentLoaded", start);

        function start() {
            getJson();

            descTab.addEventListener("click", openTab);
            specTab.addEventListener("click", openTab);
            revTab.addEventListener("click", openTab);
        }

        async function getJson() {
            console.log("getJson");

            //Henter nu kun JSON data for den enkelte post jeg har klikket på
            const url = "http://viktorkjeldal.dk/kea/2sem/kogacenter_cph/wordpress/wp-json/wp/v2/cykel/" + id;
            const jsonData = await fetch(url);
            bike = await jsonData.json();

            console.log(bike);

            showBike();
        }

        function showBike() {
            document.querySelector("title").textContent = "Kogacenter | " + bike.kategori + " | " + bike.title.rendered;
            document.querySelector('meta[name="description"]').setAttribute("content", bike.meta_description);

            document.querySelector(".s_bike_img").src = bike.billede.guid;
            document.querySelector(".s_bike_img").alt = bike.alt_tag;
            document.querySelector(".s_model").textContent = "KOGA " + bike.model;
            document.querySelector(".s_color").textContent = "Farve: " + bike.farve;
            document.querySelector(".s_weight").textContent = "Vægt: " + bike.weight;
            document.querySelector(".s_pris").textContent = "Pris: " + bike.pris + " DKK";

            document.querySelector("#desc p").textContent = bike.lang_1;
            document.querySelector("#desc p+p").textContent = bike.lang_2;
            document.querySelector("#desc p+p+p").textContent = bike.lang_3;

            document.querySelector("#specs ul li").textContent = bike.spec_1;
            document.querySelector("#specs ul li+li").textContent = bike.spec_2;
            document.querySelector("#specs ul li+li+li").textContent = bike.spec_3;
            document.querySelector("#specs ul li+li+li+li").textContent = bike.spec_4;
            document.querySelector("#specs ul li+li+li+li+li").textContent = bike.spec_5;
            document.querySelector("#specs ul li+li+li+li+li+li").textContent = bike.spec_6;
        }

        function openTab() {
            console.log("openTab");

            descTab.className = "tab_closed";
            specTab.className = "tab_closed";
            revTab.className = "tab_closed";

            this.classList.add("tab_selected");

            detail = this.dataset.detail;

            desc.style.display = "none";
            specs.style.display = "none";
            rev.style.display = "none";

            console.log(detail);

            document.querySelector(detail).style.display = "block";
        }
    </script>
    <script src="main.js"></script>
</body></html>
