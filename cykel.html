<!DOCTYPE html>
<html lang="da">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <title></title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <main>
        <section class="single_bike">
            <img class="s_bike_img" src="" alt="">
            <section class="info">
                <h1 class="s_model"></h1>
                <p class="s_color"></p>
                <p class="s_weight"></p>
                <p class="s_pris"></p>
            </section>
            <section class="details">
                <div class="tab">
                    <button class="tablinks tab_selected" id="desc_tab">Beskrivelse</button>
                    <button class="tablinks tab_closed" id="spec_tab">Specifikationer</button>
                    <button class="tablinks tab_closed" id="rev_tab">Anmeldelser</button>
                </div>

                <div id="desc" class="tabcontent">
                    <h2></h2>
                    <p></p>
                </div>

                <div id="specs" class="tabcontent">
                    <h2></h2>
                    <p></p>
                </div>

                <div id="rev" class="tabcontent">
                    <h2>Ingen anmeldelser fundet.</h2>
                </div>
            </section>
        </section>
    </main>
    <script>
        //Søger i adresselinjen efter ordet "id" og sætter konstanten id lig med
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get("id");

        console.log(id);

        let bike;

        document.addEventListener("DOMContentLoaded", start);

        function start() {
            getJson();
            document.querySelector("#desc_tab").addEventListener("click", openDesc);
            document.querySelector("#spec_tab").addEventListener("click", openSpecs);
            document.querySelector("#rev_tab").addEventListener("click", openRev);
        }

        async function getJson() {
            console.log("getJson");

            //Henter nu kun JSON data for den enkelte post jeg har klikket på
            const url = "http://viktorkjeldal.dk/kea/2sem/kogacenter_cph/wordpress/wp-json/wp/v2/cykel/" + id;
            const jsonData = await fetch(url);
            bike = await jsonData.json();

            console.log(bike);

            showBike();
        }

        function showBike() {
            document.querySelector("title").textContent = bike.kategorier + " | " + bike.title.rendered;
            document.querySelector('meta[name="description"]').setAttribute("content", bike.meta_description);

            document.querySelector(".s_bike_img").src = bike.billede.guid;
            document.querySelector(".s_bike_img").alt = bike.alt_tag;
            document.querySelector(".s_model").textContent = "KOGA " + bike.model;
            document.querySelector(".s_color").textContent = "Farve: " + bike.farve;
            document.querySelector(".s_weight").textContent = "Vægt: " + bike.weight;
            document.querySelector("#desc p").textContent = bike.lang;
            document.querySelector(".s_pris").textContent = "Pris: " + bike.pris + " DKK";
        }


        function openDesc() {
            console.log("openDesc");

            document.querySelector("#desc_tab").classList.remove("tab_closed");
            document.querySelector("#desc_tab").classList.add("tab_selected");
            document.querySelector("#desc").style.display = "block";

            document.querySelector("#spec_tab").classList.remove("tab_selected");
            document.querySelector("#spec_tab").classList.add("tab_closed");
            document.querySelector("#specs").style.display = "none";

            document.querySelector("#rev_tab").classList.remove("tab_selected");
            document.querySelector("#rev_tab").classList.add("tab_closed");
            document.querySelector("#rev").style.display = "none";
        }

        function openSpecs() {
            console.log("openSpecs");

            document.querySelector("#desc_tab").classList.remove("tab_selected");
            document.querySelector("#desc_tab").classList.add("tab_closed");
            document.querySelector("#desc").style.display = "none";

            document.querySelector("#spec_tab").classList.remove("tab_closed");
            document.querySelector("#spec_tab").classList.add("tab_selected");
            document.querySelector("#specs").style.display = "block";

            document.querySelector("#rev_tab").classList.remove("tab_selected");
            document.querySelector("#rev_tab").classList.add("tab_closed");
            document.querySelector("#rev").style.display = "none";
        }

        function openRev() {
            console.log("openRev");

            document.querySelector("#desc_tab").classList.remove("tab_selected");
            document.querySelector("#desc_tab").classList.add("tab_closed");
            document.querySelector("#desc").style.display = "none";

            document.querySelector("#spec_tab").classList.remove("tab_selected");
            document.querySelector("#spec_tab").classList.add("tab_closed");
            document.querySelector("#specs").style.display = "none";

            document.querySelector("#rev_tab").classList.remove("tab_closed");
            document.querySelector("#rev_tab").classList.add("tab_selected");
            document.querySelector("#rev").style.display = "block";
        }

    </script>
</body>

</html>
